const categoryProducts = {
  'geomatic-applications': {
    title: 'Geomatic Applications',
    products: [
      {
        name: 'Enterprise Rack Server',
        image: 'assets/remotesesing.jpg',
        //detailUrl: 'produk-detail.php?id=enterprise-rack-server' 
      },
      {
        name: 'Geographic Information System',
        image: 'assets/Geograpic-Information-System.jpg',
        icon: 'fas fa-database',
        //detailUrl: 'produk-detail.php?id=storage-area-network'
      },
      {
        name: 'Peta RBI Skala 1:5000 Wilayah KEK Tanjung Lesung Menggunakan Data Foto Udara dan Lidar Tahun 2017',
        image: 'assets/Fotogrametri.jpg',
        icon: 'fas fa-hdd',
        //detailUrl: 'produk-detail.php?id=network-attached-storage'
      },
      {
        name: 'Lidar Survey',
        image: 'assets/lidar1.jpg',
        icon: 'fas fa-shield-alt',
        //detailUrl: 'produk-detail.php?id=backup-recovery-suite'
      },
      {
        name: 'Topographic Survey',
        image: 'assets/topograpsurvey.jpg',
        icon: 'fas fa-cubes',
        //detailUrl: 'produk-detail.php?id=virtualization-platform'
      },
      {
        name: 'Studi Survey Alur',
        image: 'assets/Studi Survey Alur.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      },
      {
        name: 'Peta Sistem Lahan Skala 1:50.000 Provinsi Sumatera Selatan',
        image: 'assets/peta sistem lahan.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      },
      {
        name: 'Peta Morfometri Bentang Lahan 1:50.000 tahun 2018',
        image: 'assets/Peta Morfometri.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      },
      {
        name: 'Peta Penutup Lahan tahun 2016',
        image: 'assets/Peta Penutup Lahan.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      },
      {
        name: 'Peta RBI Skala 1:5000 Kab Gunungmas menggunakan data foto udara dan Lidar th 2019',
        image: 'assets/Fotogrametri2.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      },
      {
        name: 'Hidrographic Survey',
        image: 'assets/hidrograpsurvey1.jpg',
        icon: 'fas fa-memory',
        //detailUrl: 'produk-detail.php?id=high-performance-storage'
      }
    ]
  },
  'software-provider': {
    title: 'Software Provider',
    products: [
      {
        name: 'ArcGIS For Desktop',
        image: 'assets/arcgis_destop.jpg',
        icon: 'fas fa-network-wired',
        //detailUrl: 'produk-detail.php?id=enterprise-core-switch'
      },
      {
        name: 'ArcGIS Enterprise',
        image: 'assets/arcgisportal.jpg',
        icon: 'fas fa-wifi',
        //detailUrl: 'produk-detail.php?id=wireless-access-point'
      },
      {
        name: 'ArcGIS Mobile',
        image: 'assets/arcgis_mobile.jpg',
        icon: 'fas fa-shield-alt',
        //detailUrl: 'produk-detail.php?id=next-gen-firewall'
      },
      {
        name: 'Erdas Image',
        image: 'assets/erdas image.jpg',
        icon: 'fas fa-balance-scale',
        //detailUrl: 'produk-detail.php?id=load-balancer'
      },
      {
        name: 'Erdas Apollo',
        image: 'assets/erdas apolo.jpg',
        icon: 'fas fa-chart-line',
        //detailUrl: 'produk-detail.php?id=network-monitoring-tools'
      }
    ]
  },
  'enrm': {
    title: 'Environment & Natural Resources Management',
    products: [
      {
        name: 'Crystal Zone Management',
        image: 'assets/coastal zone.jpg',
        icon: 'fas fa-laptop',
        //detailUrl: 'produk-detail.php?id=endpoint-detection-response'
      },
      {
        name: 'Forest & Plantation Inventory',
        image: 'assets/logo.png',
        icon: 'fas fa-envelope-open-text',
        //detailUrl: 'produk-detail.php?id=email-security-gateway'
      },
      {
        name: 'Natural Resources Accounting',
        image: 'assets/logo.png',
        icon: 'fas fa-search',
        //detailUrl: 'produk-detail.php?id=siem-platform'
      },
      {
        name: 'Environment Monitoring',
        image: 'assets/logo.png',
        icon: 'fas fa-globe',
        //detailUrl: 'produk-detail.php?id=web-application-firewall'
      }
    ]
  },
  'gis-data-provider': {
    title: 'GIS Data Provider',
    products: [
      {
        name: 'Maxar',
        image: 'assets/maxar.jpeg',
        icon: 'fas fa-cloud',
        //detailUrl: 'produk-detail.php?id=public-cloud-services'
      },
      {
        name: 'Planetscope',
        image: 'assets/logo.png',
        icon: 'fas fa-cloud-upload-alt',
        //detailUrl: 'produk-detail.php?id=private-cloud-infrastructure'
      },
      {
        name: 'Radarsat',
        image: 'assets/radarsat.jpg',
        icon: 'fas fa-life-ring',
        //detailUrl: 'produk-detail.php?id=disaster-recovery-service'
      },
      {
        name: 'Scanned Map',
        image: 'assets/scanned map.jpg',
        icon: 'fas fa-exchange-alt',
        //detailUrl: 'produk-detail.php?id=cloud-migration-services'
      },
      {
        name: 'Vector Map',
        image: 'assets/vector map.jpg',
        icon: 'fas fa-cloud-download-alt',
        //detailUrl: 'produk-detail.php?id=hybrid-cloud-solutions'
      },
      {
        name: 'Data Converter',
        image: 'assets/logo.png',
        icon: 'fas fa-cubes',
        //detailUrl: 'produk-detail.php?id=container-orchestration'
      },
      {
        name: 'POI',
        image: 'assets/logo.png',
        icon: 'fas fa-cubes',
        //detailUrl: 'produk-detail.php?id=container-orchestration'
      }
    ]
  },
  'gis-information-technology': {
    title: 'GIS & Information Technology',
    products: [
      {
        name: 'Web, Desktop, Mobile Application',
        image: 'assets/application.jpg',
        icon: 'fas fa-warehouse',
        detailUrl: 'produk-detail.php?id=data-warehouse-platform'
      },
      {
        name: 'GPS Tracking System',
        image: 'assets/logo.png',
        icon: 'fas fa-chart-bar',
        detailUrl: 'produk-detail.php?id=business-analytics-suite'
      }
    ]
  },
};

// Function to show category products
function showCategoryProducts(categoryKey) {
  const displayArea = document.getElementById('category-products-display');
  const titleElement = document.getElementById('category-title');
  const descriptionElement = document.getElementById('category-description');
  const productsGrid = document.getElementById('products-grid');

  const categoryData = categoryProducts[categoryKey];
  if (!categoryData) return;

  // Set category info
  titleElement.textContent = categoryData.title;
  descriptionElement.textContent = categoryData.description;

  // Clear existing products
  productsGrid.innerHTML = '';

  // Add products
  categoryData.products.forEach(product => {
    const productCard = document.createElement('div');
    productCard.className = 'individual-product';
    productCard.innerHTML = `
      <div class="product-image">
        ${product.image ? 
          `<img src="${product.image}" alt="${product.name}" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
           <i class="${product.icon}" style="display:none;"></i>` 
          : 
          `<i class="${product.icon}"></i>`
        }
      </div>
      <div class="product-info">
        <h4 class="product-name">${product.name}</h4>
      </div>
    `;
    productsGrid.appendChild(productCard);
  });

  // Show the display area and scroll into view
  displayArea.classList.add('active');
  setTimeout(() => {
    displayArea.scrollIntoView({ behavior: 'smooth', block: 'start' });
  }, 100);
}

// Function to close category display
function closeCategoryDisplay() {
  const displayArea = document.getElementById('category-products-display');
  displayArea.classList.remove('active');
}

// Initialize product page functionality
document.addEventListener('DOMContentLoaded', function() {
  // Add event listeners to category buttons
  document.querySelectorAll('.category-btn').forEach(btn => {
    btn.addEventListener('click', function() {
      const category = this.getAttribute('data-category');
      showCategoryProducts(category);
    });
  });

  // Category card interaction
  document.querySelectorAll('.category-card').forEach(card => {
    card.addEventListener('mouseenter', function() {
      this.style.transform = 'translateY(-10px) scale(1.02)';
    });
    
    card.addEventListener('mouseleave', function() {
      this.style.transform = 'translateY(0) scale(1)';
    });
  });

  // Add fade-in animation on scroll for product elements
  const observerOptions = {
    threshold: 0.1,
    rootMargin: '0px 0px -50px 0px'
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.style.opacity = '1';
        entry.target.style.transform = 'translateY(0)';
      }
    });
  }, observerOptions);

  // Observe product elements for animation
  document.querySelectorAll('.fade-in-up').forEach(el => {
    el.style.opacity = '0';
    el.style.transform = 'translateY(30px)';
    el.style.transition = 'opacity 0.6s ease, transform 0.6s ease';
    observer.observe(el);
  });
});

// Add CSS for ripple effect
const style = document.createElement('style');
style.textContent = `
  .product-btn {
    position: relative;
    overflow: hidden;
  }
  
  .ripple {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.3);
    transform: scale(0);
    animation: rippleEffect 0.6s linear;
    pointer-events: none;
  }
  
  @keyframes rippleEffect {
    to {
      transform: scale(4);
      opacity: 0;
    }
  }
`;
document.head.appendChild(style);

// Parallax effect for page header
window.addEventListener('scroll', () => {
  const scrolled = window.pageYOffset;
  const header = document.querySelector('.page-header');
  const speed = scrolled * 0.5;
  
  if (header) {
    header.style.transform = `translateY(${speed}px)`;
  }
});

// Counter animation for statistics (utility function)
function animateCounter(element, target, duration = 2000) {
  let start = 0;
  const increment = target / (duration / 16);
  const timer = setInterval(() => {
    start += increment;
    element.textContent = Math.floor(start);
    if (start >= target) {
      element.textContent = target;
      clearInterval(timer);
    }
  }, 16);
}

// Loading animation
window.addEventListener('load', () => {
  document.body.classList.add('loaded');
  
  // Trigger animations for elements in viewport
  document.querySelectorAll('.fade-in-up').forEach((el, index) => {
    setTimeout(() => {
      el.style.opacity = '1';
      el.style.transform = 'translateY(0)';
    }, index * 100);
  });
});

// Search functionality (for future use)
function filterProducts(searchTerm) {
  const products = document.querySelectorAll('.individual-product');
  const categories = document.querySelectorAll('.category-card');
  
  products.forEach(product => {
    const name = product.querySelector('.product-name');
    if (name) {
      const productName = name.textContent.toLowerCase();
      if (productName.includes(searchTerm.toLowerCase())) {
        product.style.display = 'block';
      } else {
        product.style.display = 'none';
      }
    }
  });
  
  categories.forEach(category => {
    const title = category.querySelector('h3').textContent.toLowerCase();
    const description = category.querySelector('p').textContent.toLowerCase();
    const productItems = Array.from(category.querySelectorAll('.category-products li'))
      .map(li => li.textContent.toLowerCase()).join(' ');
    
    if (title.includes(searchTerm.toLowerCase()) || 
        description.includes(searchTerm.toLowerCase()) || 
        productItems.includes(searchTerm.toLowerCase())) {
      category.style.display = 'block';
    } else {
      category.style.display = 'none';
    }
  });
}

// Lazy loading for images (utility function)
const imageObserver = new IntersectionObserver((entries, observer) => {
  entries.forEach(entry => {
    if (entry.isIntersecting) {
      const img = entry.target;
      if (img.dataset.src) {
        img.src = img.dataset.src;
        img.classList.remove('lazy');
        imageObserver.unobserve(img);
      }
    }
  });
});

// Initialize lazy loading for any images with data-src attribute
document.querySelectorAll('img[data-src]').forEach(img => {
  imageObserver.observe(img);
});

// Utility function to show notifications
function showNotification(message, type = 'success') {
  const notification = document.createElement('div');
  notification.className = `notification ${type}`;
  notification.style.cssText = `
    position: fixed;
    top: 100px;
    right: 20px;
    background: ${type === 'success' ? '#10b981' : '#ef4444'};
    color: white;
    padding: 1rem 2rem;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    z-index: 1000;
    animation: slideInRight 0.3s ease-out;
    max-width: 300px;
  `;
  notification.textContent = message;

  document.body.appendChild(notification);

  // Remove after 3 seconds
  setTimeout(() => {
    notification.style.animation = 'slideOutRight 0.3s ease-in';
    setTimeout(() => notification.remove(), 300);
  }, 3000);
}

// Add CSS animations for notifications
const notificationStyle = document.createElement('style');
notificationStyle.textContent = `
  @keyframes slideInRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }
  
  @keyframes slideOutRight {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }
`;
document.head.appendChild(notificationStyle);
